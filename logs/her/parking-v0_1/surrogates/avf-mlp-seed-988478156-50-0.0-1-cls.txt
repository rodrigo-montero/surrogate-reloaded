INFO:avf_train:Args: Namespace(algo='her', avf_policy='mlp', batch_size=256, build_heldout_test=False, env_id='parking-v0', env_name='park', exp_id=9, folder='logs', heldout_test_file='heldout-set-seed-0-0.3-split-5-filter-cls.npz', layers=1, learning_rate=0.0003, n_epochs=2000, no_test_set=False, oversample=0.0, patience=10, preprocess=False, regression=False, save_data=False, seed=988478156, test_split=0.3, training_progress_filter=50, training_stability=1, weight_decay=0.0, weight_loss=True)
INFO:preprocessor:Number of samples: 8788
INFO:preprocessor:Data balancing: 0.06019572143832499
INFO:preprocessor:Training progress filter 0.0. Considering env configurations from episode 1 to episode 8788. Number of failures 529/8788
INFO:Avf:Train data labels proportion: 0.02347791484281735
INFO:Avf:Validation data labels proportion: 0.02411873840445269
INFO:Avf:Test data labels proportion: 0.04805843906189927
INFO:Avf:Failures train dataset: 59.0/2454.0 non failures
INFO:Avf:Failures validation dataset: 26.0/1052.0 non failures
INFO:Avf:Failures test dataset: 125/2476 non failures
INFO:Avf:Train dataset size: 2513, Validation dataset size: 1078, Test dataset size: 2601
INFO:Avf:Model architecture: Sequential(
  (0): Linear(in_features=24, out_features=32, bias=True)
  (1): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (2): ReLU()
  (3): Linear(in_features=32, out_features=2, bias=True)
)
INFO:Avf:Validation loss: 1.42, Validation accuracy: 0.97, Precision failure class: 0.00, Recall failure class: 0.00, Epoch: 0
INFO:Avf:New best validation precision: 0.0. Saving model to path: logs/her/parking-v0_9/surrogates/best-avf-mlp-50-0.0-1.pkl
INFO:Avf:Corresponding validation loss: 1.4171842336654663
INFO:Avf:Train loss: 0.86, Train accuracy: 0.98, Epoch: 1
INFO:Avf:Train loss: 0.84, Train accuracy: 0.98, Epoch: 2
INFO:Avf:Train loss: 0.77, Train accuracy: 0.98, Epoch: 3
INFO:Avf:Train loss: 0.79, Train accuracy: 0.98, Epoch: 4
INFO:Avf:Train loss: 0.77, Train accuracy: 0.97, Epoch: 5
INFO:Avf:Validation loss: 0.74, Validation accuracy: 0.97, Precision failure class: 0.00, Recall failure class: 0.00, Epoch: 5
INFO:Avf:Train loss: 0.77, Train accuracy: 0.97, Epoch: 6
INFO:Avf:Train loss: 0.75, Train accuracy: 0.97, Epoch: 7
INFO:Avf:Train loss: 0.74, Train accuracy: 0.96, Epoch: 8
INFO:Avf:Train loss: 0.71, Train accuracy: 0.95, Epoch: 9
INFO:Avf:Train loss: 0.71, Train accuracy: 0.94, Epoch: 10
INFO:Avf:Validation loss: 0.67, Validation accuracy: 0.92, Precision failure class: 0.06, Recall failure class: 0.18, Epoch: 10
INFO:Avf:New best validation precision: 0.06016644174538911. Saving model to path: logs/her/parking-v0_9/surrogates/best-avf-mlp-50-0.0-1.pkl
INFO:Avf:Corresponding validation loss: 0.6658203601837158
INFO:Avf:Train loss: 0.70, Train accuracy: 0.92, Epoch: 11
INFO:Avf:Train loss: 0.67, Train accuracy: 0.91, Epoch: 12
INFO:Avf:Train loss: 0.68, Train accuracy: 0.89, Epoch: 13
INFO:Avf:Train loss: 0.64, Train accuracy: 0.87, Epoch: 14
INFO:Avf:Train loss: 0.66, Train accuracy: 0.85, Epoch: 15
INFO:Avf:Validation loss: 0.63, Validation accuracy: 0.82, Precision failure class: 0.07, Recall failure class: 0.44, Epoch: 15
INFO:Avf:New best validation precision: 0.06595744680851064. Saving model to path: logs/her/parking-v0_9/surrogates/best-avf-mlp-50-0.0-1.pkl
INFO:Avf:Corresponding validation loss: 0.6284050494432449
INFO:Avf:Train loss: 0.65, Train accuracy: 0.83, Epoch: 16
INFO:Avf:Train loss: 0.64, Train accuracy: 0.82, Epoch: 17
INFO:Avf:Train loss: 0.65, Train accuracy: 0.79, Epoch: 18
INFO:Avf:Train loss: 0.63, Train accuracy: 0.78, Epoch: 19
INFO:Avf:Train loss: 0.63, Train accuracy: 0.76, Epoch: 20
INFO:Avf:Validation loss: 0.62, Validation accuracy: 0.73, Precision failure class: 0.06, Recall failure class: 0.64, Epoch: 20
INFO:Avf:Train loss: 0.62, Train accuracy: 0.76, Epoch: 21
INFO:Avf:Train loss: 0.62, Train accuracy: 0.75, Epoch: 22
INFO:Avf:Train loss: 0.62, Train accuracy: 0.74, Epoch: 23
INFO:Avf:Train loss: 0.62, Train accuracy: 0.74, Epoch: 24
INFO:Avf:Train loss: 0.60, Train accuracy: 0.72, Epoch: 25
INFO:Avf:Validation loss: 0.60, Validation accuracy: 0.69, Precision failure class: 0.05, Recall failure class: 0.80, Epoch: 25
INFO:Avf:Train loss: 0.61, Train accuracy: 0.71, Epoch: 26
INFO:Avf:Train loss: 0.61, Train accuracy: 0.70, Epoch: 27
INFO:Avf:Train loss: 0.60, Train accuracy: 0.71, Epoch: 28
INFO:Avf:Train loss: 0.59, Train accuracy: 0.71, Epoch: 29
INFO:Avf:Train loss: 0.60, Train accuracy: 0.70, Epoch: 30
INFO:Avf:Validation loss: 0.59, Validation accuracy: 0.68, Precision failure class: 0.06, Recall failure class: 0.83, Epoch: 30
INFO:Avf:Train loss: 0.59, Train accuracy: 0.70, Epoch: 31
INFO:Avf:Train loss: 0.59, Train accuracy: 0.71, Epoch: 32
INFO:Avf:Train loss: 0.59, Train accuracy: 0.70, Epoch: 33
INFO:Avf:Train loss: 0.59, Train accuracy: 0.70, Epoch: 34
INFO:Avf:Train loss: 0.59, Train accuracy: 0.70, Epoch: 35
INFO:Avf:Validation loss: 0.60, Validation accuracy: 0.68, Precision failure class: 0.05, Recall failure class: 0.69, Epoch: 35
INFO:Avf:Train loss: 0.58, Train accuracy: 0.71, Epoch: 36
INFO:Avf:Train loss: 0.58, Train accuracy: 0.70, Epoch: 37
INFO:Avf:Train loss: 0.58, Train accuracy: 0.69, Epoch: 38
INFO:Avf:Train loss: 0.57, Train accuracy: 0.69, Epoch: 39
INFO:Avf:Train loss: 0.57, Train accuracy: 0.69, Epoch: 40
INFO:Avf:Validation loss: 0.58, Validation accuracy: 0.68, Precision failure class: 0.06, Recall failure class: 0.74, Epoch: 40
INFO:Avf:Train loss: 0.58, Train accuracy: 0.70, Epoch: 41
INFO:Avf:Train loss: 0.56, Train accuracy: 0.70, Epoch: 42
INFO:Avf:Train loss: 0.56, Train accuracy: 0.70, Epoch: 43
INFO:Avf:Train loss: 0.57, Train accuracy: 0.71, Epoch: 44
INFO:Avf:Train loss: 0.56, Train accuracy: 0.72, Epoch: 45
INFO:Avf:Validation loss: 0.58, Validation accuracy: 0.69, Precision failure class: 0.05, Recall failure class: 0.65, Epoch: 45
INFO:Avf:Train loss: 0.56, Train accuracy: 0.72, Epoch: 46
INFO:Avf:Train loss: 0.55, Train accuracy: 0.72, Epoch: 47
INFO:Avf:Train loss: 0.56, Train accuracy: 0.72, Epoch: 48
INFO:Avf:Train loss: 0.55, Train accuracy: 0.72, Epoch: 49
INFO:Avf:Train loss: 0.55, Train accuracy: 0.71, Epoch: 50
INFO:Avf:Validation loss: 0.55, Validation accuracy: 0.69, Precision failure class: 0.05, Recall failure class: 0.74, Epoch: 50
INFO:Avf:Train loss: 0.55, Train accuracy: 0.72, Epoch: 51
INFO:Avf:Train loss: 0.54, Train accuracy: 0.72, Epoch: 52
INFO:Avf:Train loss: 0.55, Train accuracy: 0.71, Epoch: 53
INFO:Avf:Train loss: 0.54, Train accuracy: 0.72, Epoch: 54
INFO:Avf:Train loss: 0.54, Train accuracy: 0.72, Epoch: 55
INFO:Avf:Validation loss: 0.57, Validation accuracy: 0.70, Precision failure class: 0.06, Recall failure class: 0.64, Epoch: 55
INFO:Avf:Train loss: 0.54, Train accuracy: 0.73, Epoch: 56
INFO:Avf:Train loss: 0.54, Train accuracy: 0.72, Epoch: 57
INFO:Avf:Train loss: 0.54, Train accuracy: 0.71, Epoch: 58
INFO:Avf:Train loss: 0.54, Train accuracy: 0.72, Epoch: 59
INFO:Avf:Train loss: 0.53, Train accuracy: 0.73, Epoch: 60
INFO:Avf:Validation loss: 0.58, Validation accuracy: 0.70, Precision failure class: 0.05, Recall failure class: 0.64, Epoch: 60
INFO:Avf:Train loss: 0.53, Train accuracy: 0.73, Epoch: 61
INFO:Avf:Train loss: 0.53, Train accuracy: 0.72, Epoch: 62
INFO:Avf:Train loss: 0.53, Train accuracy: 0.73, Epoch: 63
INFO:Avf:Train loss: 0.53, Train accuracy: 0.73, Epoch: 64
INFO:Avf:Train loss: 0.52, Train accuracy: 0.74, Epoch: 65
INFO:Avf:Validation loss: 0.57, Validation accuracy: 0.71, Precision failure class: 0.05, Recall failure class: 0.64, Epoch: 65
INFO:Avf:Early stopping! No improvement in validation loss for 10 epochs
INFO:Avf:Accuracy test set: 0.7231833910034602
INFO:Avf:Target: [0 1 1 ... 0 0 0]
INFO:Avf:Predictions: [0 0 1 ... 0 0 1]
INFO:Avf:Precision: 0.09
INFO:Avf:Recall: 0.53
INFO:Avf:F-measure: 0.15
INFO:Avf:AUROC: 0.68
INFO:avf_train:Training metrics test losses. Mean: 0.65, Std: 0.00 (0%), Min: 0.65, Max: 0.65
INFO:avf_train:Training metrics best epochs. Mean: 15.00, Std: 0.00 (0%), Min: 15.00, Max: 15.00
INFO:avf_train:Training metrics test precisions. Mean: 0.09, Std: 0.00 (0%), Min: 0.09, Max: 0.09
INFO:avf_train:Training metrics test recalls. Mean: 0.53, Std: 0.00 (0%), Min: 0.53, Max: 0.53
INFO:avf_train:Training metrics f-measures. Mean: 0.15, Std: 0.00 (0%), Min: 0.15, Max: 0.15
INFO:avf_train:Training metrics auc_rocs. Mean: 0.68, Std: 0.00 (0%), Min: 0.68, Max: 0.68
INFO:avf_train:Training metrics test maes. Mean: 0.00, Std: 0.00 (0.0%), Min: 0.00, Max: 0.00
INFO:avf_train:Training metrics test r2s. Mean: 0.00, Std: 0.00 (0.0%), Min: 0.00, Max: 0.00
INFO:avf_train:Time elapsed: 13.136955261230469s
